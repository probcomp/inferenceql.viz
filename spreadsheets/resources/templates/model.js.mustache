/* Views */

{{#views}}
function view_{{num}}_model () {
  var cluster_id = categorical([{{cluster-probs}}]) + 1;

{{#clusters}}
{{#first}}  if (cluster_id == {{num}}) {
    return {
{{#parameters}}
      "{{name}}": {{#gaussian}}gaussian({{mu}}, {{sigma}}){{/gaussian}}{{#categorical}}categorical([{{weights}}]){{/categorical}}{{^last}},{{/last}}
{{/parameters}}
    };
{{/first}}
{{^first}}  } else if (cluster_id == {{num}}) {
    return { /* a virtual row... */ };
{{/first}}
{{/clusters}}  }
}

{{/views}}
/* Model */

{{#model}}
function model() {
  {{#view-fn-nums}}
  var view_{{.}} = view_{{.}}_model();
  {{/view-fn-nums}}

  return {{{#splats}}{{^last}}...view_{{num}}, {{/last}}{{#last}}...view_{{num}}{{/last}}{{/splats}}};
}
{{/model}}
